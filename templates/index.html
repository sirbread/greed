<!DOCTYPE html>
<html>
<head>
    <title>greed</title>
</head>
<body>
    <h1>pick a number (1-10, inclusive, integer)</h1>
    <div id="buttons"></div>

    <div id="status"></div>
    <div id="scoreboard"></div>
        <h2>scores</h2>
        <pre id="scores">Loading...</pre>
    </div>

    <script>
        const userId = Math.floor(Math.random() * 100000)
            function submit() {
                const value = ParseInt(document.getElementByID("numberInput").value)
                if (isNaN(value) || value < 1 || value > 10) {
                    document.getElementById("status").textContent = "Please enter a number from 1 to 10"
                    return
                }
                fetch("/submit/", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ user_id: userId, number_selected: value })
                }) 
                .then(res => res.json())
                .then(() => {
                    document.getElementById("status").textContent = "Submitted number " +value
                    document.getElementById("numberInput").value = ""
                    loadScores()
                })
            }

            function loadScores() {
                fetch("/scores/")
                    .then(res => res.json())
                    .then(scores => {
                        document.getElementById("scores").textContent =
                            scores.map(s => "user " + s.user_id + ": " + s.score.toFixed(2) + " (picked " + s.number + ")").join("\n")

                    })
            }

            setInterval(loadScores, 5000)
            loadScores()
        

    </script>
</body>
</html>